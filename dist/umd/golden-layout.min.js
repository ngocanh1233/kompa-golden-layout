!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?exports.GoldenLayout=e(require("jquery")):t.GoldenLayout=e(t.$)}(window,(function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(e,n){e.exports=t},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return Pe})),n.d(e,"ItemContainer",(function(){return Jt})),n.d(e,"BrowserPopout",(function(){return me})),n.d(e,"Header",(function(){return bt})),n.d(e,"HeaderButton",(function(){return ut})),n.d(e,"Tab",(function(){return ct})),n.d(e,"Component",(function(){return ae})),n.d(e,"Root",(function(){return Ut})),n.d(e,"RowOrColumn",(function(){return zt})),n.d(e,"Stack",(function(){return Et})),n.d(e,"BubblingEvent",(function(){return E})),n.d(e,"ConfigMinifier",(function(){return g})),n.d(e,"DragListener",(function(){return Q})),n.d(e,"EventEmitter",(function(){return p})),n.d(e,"EventHub",(function(){return x})),n.d(e,"ReactComponentHandler",(function(){return Qt}));var i=n(0),o=n.n(i);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return o.a.zepto?t.touches?t.targetTouches[0]:t:t.originalEvent&&t.originalEvent.touches?t.originalEvent.touches[0]:t}function a(t){if(window.location.hash)return e=t,(n=location.hash.match(new RegExp(e+"=([^&]*)")))?n[1]:null;if(!window.location.search)return null;var e,n,i,o,r=window.location.search.substr(1).split("&"),s={};for(o=0;o<r.length;o++)s[(i=r[o].split("="))[0]]=i[1];return s[t]||null}function l(t,e){for(var n in e)t[n]=e[n];return t}function c(t){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})((function(){t()}))}function h(t,e){if(!(e instanceof Array))throw new Error("Haystack is not an Array");if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var u="object"!=("undefined"==typeof Int8Array?"undefined":r(Int8Array))?function(t){return"function"==typeof t||!1}:function(t){return"[object Function]"===toString.call(t)};function f(t,e,n){if(void 0!==Function.prototype.bind)return Function.prototype.bind.apply(t,[e].concat(n||[]));var i=function i(){var o=(n||[]).concat(Array.prototype.slice.call(arguments,0));if(!(this instanceof i))return t.apply(e,o);t.apply(this,o)};return i.prototype=t.prototype,i}function d(){return(1e15*Math.random()).toString(36).replace(".","")}function m(t){return o.a.trim(t.replace(/(<([^>]+)>)/gi,""))}var p=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._mSubscriptions={},this._mSubscriptions.__all=[],this.on=function(t,e,n){if(!u(e))throw new Error("Tried to listen to event "+t+" with non-function callback "+e);this._mSubscriptions[t]||(this._mSubscriptions[t]=[]),this._mSubscriptions[t].push({fn:e,ctx:n})},this.emit=function(t){var e,n,i;i=Array.prototype.slice.call(arguments,1);var o=this._mSubscriptions[t];if(o)for(o=o.slice(),e=0;e<o.length;e++)n=o[e].ctx||{},o[e].fn.apply(n,i);i.unshift(t);var r=this._mSubscriptions.__all.slice();for(e=0;e<r.length;e++)n=r[e].ctx||{},r[e].fn.apply(n,i)},this.unbind=function(t,e,n){if(!this._mSubscriptions[t])throw new Error("No subscribtions to unsubscribe for event "+t);var i,o=!1;for(i=0;i<this._mSubscriptions[t].length;i++)e&&this._mSubscriptions[t][i].fn!==e||n&&n!==this._mSubscriptions[t][i].ctx||(this._mSubscriptions[t].splice(i,1),o=!0);if(!1===o)throw new Error("Nothing to unbind for "+t)},this.off=this.unbind,this.trigger=this.emit};function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._keys=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentName","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled","borderGrabWidth"],this._keys.length>36)throw new Error("Too many keys in config minifier map");this._values=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"]}var e,n,i;return e=t,(n=[{key:"minifyConfig",value:function(t){var e={};return this._nextLevel(t,e,"_min"),e}},{key:"unminifyConfig",value:function(t){var e={};return this._nextLevel(t,e,"_max"),e}},{key:"_nextLevel",value:function(t,e,n){var i,o;for(i in t)t instanceof Array&&(i=parseInt(i,10)),t.hasOwnProperty(i)&&(o=this[n](i,this._keys),"object"===y(t[i])?(e[o]=t[i]instanceof Array?[]:{},this._nextLevel(t[i],e[o],n)):e[o]=this[n](t[i],this._values))}},{key:"_min",value:function(t,e){if("string"==typeof t&&1===t.length)return"___"+t;var n=h(t,e);return-1===n?t:n.toString(36)}},{key:"_max",value:function(t,e){return"string"==typeof t&&1===t.length?e[parseInt(t,36)]:"string"==typeof t&&"___"===t.substr(0,3)?t[3]:t}}])&&_(e.prototype,n),i&&_(e,i),t}();function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=S(t);if(e){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?k(t):e}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(s,t);var e,n,i,r=I(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=r.call(this))._layoutManager=t,e._dontPropagateToParent=null,e._childEventSource=null,e.on("__all",f(e._onEventFromThis,k(e))),e._boundOnEventFromChild=f(e._onEventFromChild,k(e)),o()(window).on("gl_child_event",e._boundOnEventFromChild),e}return e=s,(n=[{key:"_onEventFromThis",value:function(){var t=Array.prototype.slice.call(arguments);this._layoutManager.isSubWindow&&t[0]!==this._dontPropagateToParent&&this._propagateToParent(t),this._propagateToChildren(t),this._dontPropagateToParent=null,this._childEventSource=null}},{key:"_$onEventFromParent",value:function(t){this._dontPropagateToParent=t[0],this.emit.apply(this,t)}},{key:"_onEventFromChild",value:function(t){this._childEventSource=t.originalEvent.__gl,this.emit.apply(this,t.originalEvent.__glArgs)}},{key:"_propagateToParent",value:function(t){var e;document.createEvent?(e=window.opener.document.createEvent("HTMLEvents")).initEvent("gl_child_event",!0,!0):(e=window.opener.document.createEventObject()).eventType="gl_child_event",e.eventName="gl_child_event",e.__glArgs=t,e.__gl=this._layoutManager,document.createEvent?window.opener.dispatchEvent(e):window.opener.fireEvent("on"+e.eventType,e)}},{key:"_propagateToChildren",value:function(t){var e,n;for(n=0;n<this._layoutManager.openPopouts.length;n++)(e=this._layoutManager.openPopouts[n].getGlInstance())&&e!==this._childEventSource&&e.eventHub._$onEventFromParent(t)}},{key:"destroy",value:function(){o()(window).off("gl_child_event",this._boundOnEventFromChild)}}])&&b(e.prototype,n),i&&b(e,i),s}(p);function D(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var E=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.origin=n,this.isPropagationStopped=!1}var e,n,i;return e=t,(n=[{key:"stopPropagation",value:function(){this.isPropagationStopped=!0}}])&&D(e.prototype,n),i&&D(e,i),t}();function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t){var e="function"==typeof Map?new Map:void 0;return(M=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return T(t,arguments,j(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),A(i,t)})(t)}function T(t,e,n){return(T=R()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&A(o,n.prototype),o}).apply(null,arguments)}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(o,t);var e,n,i=(e=o,n=R(),function(){var t,i=j(e);if(n){var o=j(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return O(this,t)});function o(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).name="Configuration Error",n.message=t,n.node=e,n}return o}(M(Error)),z={isClosable:!0,reorderEnabled:!0,title:""};function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function B(t,e){return(B=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=U(t);if(e){var o=U(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return L(this,n)}}function L(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?N(t):e}function N(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var X=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(r,t);var e,n,i,o=F(r);function r(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=o.call(this)).config=i._extendItemNode(e),i.type=e.type,i.contentItems=[],i.parent=n,i.isInitialised=!1,i.isMaximised=!1,i.isRoot=!1,i.isRow=!1,i.isColumn=!1,i.isStack=!1,i.isComponent=!1,i.layoutManager=t,i._pendingEventPropagations={},i._throttledEvents=["stateChanged"],i.on("__all",i._propagateEvent,N(i)),e.content&&i._createContentItems(e),i}return e=r,(n=[{key:"setSize",value:function(){throw new Error("Abstract Method")}},{key:"callDownwards",value:function(t,e,n,i){var o;for(!0!==n&&!0!==i&&this[t].apply(this,e||[]),o=0;o<this.contentItems.length;o++)this.contentItems[o].callDownwards(t,e,n);!0===n&&!0!==i&&this[t].apply(this,e||[])}},{key:"removeChild",value:function(t,e){var n=h(t,this.contentItems);if(-1===n)throw new Error("Can't remove child item. Unknown content item");!0!==e&&(this.contentItems[n]._$destroy(),this.contentItems[n].callDownwards("_$destroy",[],!0,!0)),this.contentItems.splice(n,1),this.config.content.splice(n,1),this.contentItems.length>0?this.callDownwards("setSize"):this instanceof Ut||!0!==this.config.isClosable||this.parent.removeChild(this)}},{key:"undisplayChild",value:function(t){if(-1===h(t,this.contentItems))throw new Error("Can't remove child item. Unknown content item");this instanceof Ut||!0!==this.config.isClosable||this.parent.undisplayChild(this)}},{key:"addChild",value:function(t,e){void 0===e&&(e=this.contentItems.length),this.contentItems.splice(e,0,t),void 0===this.config.content&&(this.config.content=[]),this.config.content.splice(e,0,t.config),t.parent=this,!0===t.parent.isInitialised&&!1===t.isInitialised&&t._$init()}},{key:"replaceChild",value:function(t,e,n){e=this.layoutManager._$normalizeContentItem(e);var i=h(t,this.contentItems),o=t.element[0].parentNode;if(-1===i)throw new Error("Can't replace child. oldChild is not child of this");o.replaceChild(e.element[0],t.element[0]),!0===n&&(t.parent=null,t._$destroy()),this.contentItems[i]=e,e.parent=this,this.isStack&&(this.header.tabs[i].contentItem=e),!0===e.parent.isInitialised&&!1===e.isInitialised&&e._$init(),this.callDownwards("setSize")}},{key:"remove",value:function(){this.parent.removeChild(this)}},{key:"popout",value:function(){var t=this.layoutManager.createPopout(this);return this.emitBubblingEvent("stateChanged"),t}},{key:"toggleMaximise",value:function(t){t&&t.preventDefault(),!0===this.isMaximised?this.layoutManager._$minimiseItem(this):this.layoutManager._$maximiseItem(this),this.isMaximised=!this.isMaximised,this.emitBubblingEvent("stateChanged")}},{key:"select",value:function(){this.layoutManager.selectedItem!==this&&(this.layoutManager.selectItem(this,!0),this.element.addClass("lm_selected"))}},{key:"deselect",value:function(){this.layoutManager.selectedItem===this&&(this.layoutManager.selectedItem=null,this.element.removeClass("lm_selected"))}},{key:"setTitle",value:function(t){this.config.title=t,this.emit("titleChanged",t),this.emit("stateChanged")}},{key:"hasId",value:function(t){return!!this.config.id&&("string"==typeof this.config.id?this.config.id===t:this.config.id instanceof Array?-1!==h(t,this.config.id):void 0)}},{key:"addId",value:function(t){this.hasId(t)||(this.config.id?"string"==typeof this.config.id?this.config.id=[this.config.id,t]:this.config.id instanceof Array&&this.config.id.push(t):this.config.id=t)}},{key:"removeId",value:function(t){if(!this.hasId(t))throw new Error("Id not found");if("string"==typeof this.config.id)delete this.config.id;else if(this.config.id instanceof Array){var e=h(t,this.config.id);this.config.id.splice(e,1)}}},{key:"getItemsByFilter",value:function(t){var e=[];return function n(i){for(var o=0;o<i.contentItems.length;o++)!0===t(i.contentItems[o])&&e.push(i.contentItems[o]),n(i.contentItems[o])}(this),e}},{key:"getItemsById",value:function(t){return this.getItemsByFilter((function(e){return e.config.id instanceof Array?-1!==h(t,e.config.id):e.config.id===t}))}},{key:"getItemsByType",value:function(t){return this._$getItemsByProperty("type",t)}},{key:"getComponentsByName",value:function(t){var e,n=this._$getItemsByProperty("componentName",t),i=[];for(e=0;e<n.length;e++)i.push(n[e].instance);return i}},{key:"_$getItemsByProperty",value:function(t,e){return this.getItemsByFilter((function(n){return n[t]===e}))}},{key:"_$setParent",value:function(t){this.parent=t}},{key:"_$highlightDropZone",value:function(t,e,n){this.layoutManager.dropTargetIndicator.highlightArea(n)}},{key:"_$onDrop",value:function(t){this.addChild(t)}},{key:"_$hide",value:function(){this._callOnActiveComponents("hide"),this.element.hide(),this.layoutManager.updateSize()}},{key:"_$show",value:function(){this._callOnActiveComponents("show"),this.element.show(),this.layoutManager.updateSize()}},{key:"_callOnActiveComponents",value:function(t){var e,n,i=this.getItemsByType("stack");for(n=0;n<i.length;n++)(e=i[n].getActiveContentItem())&&e.isComponent&&e.container[t]()}},{key:"_$destroy",value:function(){this.emitBubblingEvent("beforeItemDestroyed"),this.element.remove(),this.emitBubblingEvent("itemDestroyed")}},{key:"_$getArea",value:function(t){var e=(t=t||this.element).offset(),n=t.width(),i=t.height();return{x1:e.left,y1:e.top,x2:e.left+n,y2:e.top+i,surface:n*i,contentItem:this}}},{key:"_$init",value:function(){var t;for(this.setSize(),t=0;t<this.contentItems.length;t++)this.childElementContainer.append(this.contentItems[t].element);this.isInitialised=!0,this.emitBubblingEvent("itemCreated"),this.emitBubblingEvent(this.type+"Created")}},{key:"emitBubblingEvent",value:function(t){var e=new E(t,this);this.emit(t,e)}},{key:"_createContentItems",value:function(t){var e,n;if(!(t.content instanceof Array))throw new $("content must be an Array",t);for(n=0;n<t.content.length;n++)e=this.layoutManager.createContentItem(t.content[n],this),this.contentItems.push(e)}},{key:"_extendItemNode",value:function(t){for(var e in z)void 0===t[e]&&(t[e]=z[e]);return t}},{key:"_propagateEvent",value:function(t,e){e instanceof E&&!1===e.isPropagationStopped&&!0===this.isInitialised&&(!1===this.isRoot&&this.parent?this.parent.emit.apply(this.parent,Array.prototype.slice.call(arguments,0)):this._scheduleEventPropagationToLayoutManager(t,e))}},{key:"_scheduleEventPropagationToLayoutManager",value:function(t,e){-1===h(t,this._throttledEvents)?this.layoutManager.emit(t,e.origin):!0!==this._pendingEventPropagations[t]&&(this._pendingEventPropagations[t]=!0,c(f(this._propagateEventToLayoutManager,this,[t,e])))}},{key:"_propagateEventToLayoutManager",value:function(t,e){this._pendingEventPropagations[t]=!1,this.layoutManager.emit(t,e)}}])&&H(e.prototype,n),i&&H(e,i),r}(p);function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=K(t);if(e){var o=K(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return q(this,n)}}function q(t,e){return!e||"object"!==G(e)&&"function"!=typeof e?J(t):e}function J(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(a,t);var e,n,i,r=Z(a);function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=r.call(this))._timeout=null,n._eElement=o()(t),n._oDocument=o()(document),n._eBody=o()(document.body),n._nButtonCode=e||0,n._nDelay=200,n._nDistance=10,n._nX=0,n._nY=0,n._nOriginalX=0,n._nOriginalY=0,n._bDragging=!1,n._fMove=f(n.onMouseMove,J(n)),n._fUp=f(n.onMouseUp,J(n)),n._fDown=f(n.onMouseDown,J(n)),n._eElement.on("mousedown touchstart",n._fDown),n}return e=a,(n=[{key:"destroy",value:function(){this._eElement.unbind("mousedown touchstart",this._fDown),this._oDocument.unbind("mouseup touchend",this._fUp),this._eElement=null,this._oDocument=null,this._eBody=null}},{key:"onMouseDown",value:function(t){if(t.preventDefault(),0==t.button||"touchstart"===t.type){var e=this._getCoordinates(t);this._nOriginalX=e.x,this._nOriginalY=e.y,this._oDocument.on("mousemove touchmove",this._fMove),this._oDocument.one("mouseup touchend",this._fUp),this._timeout=setTimeout(f(this._startDrag,this),this._nDelay)}}},{key:"onMouseMove",value:function(t){if(null!=this._timeout){t.preventDefault();var e=this._getCoordinates(t);this._nX=e.x-this._nOriginalX,this._nY=e.y-this._nOriginalY,!1===this._bDragging&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&(clearTimeout(this._timeout),this._startDrag()),this._bDragging&&this.emit("drag",this._nX,this._nY,t)}}},{key:"onMouseUp",value:function(t){null!=this._timeout&&(clearTimeout(this._timeout),this._eBody.removeClass("lm_dragging"),this._eElement.removeClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events",""),this._oDocument.unbind("mousemove touchmove",this._fMove),this._oDocument.unbind("mouseup touchend",this._fUp),!0===this._bDragging&&(this._bDragging=!1,this.emit("dragStop",t,this._nOriginalX+this._nX)))}},{key:"_startDrag",value:function(){this._bDragging=!0,this._eBody.addClass("lm_dragging"),this._eElement.addClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)}},{key:"_getCoordinates",value:function(t){return{x:(t=s(t)).pageX,y:t.pageY}}}])&&Y(e.prototype,n),i&&Y(e,i),a}(p);function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function nt(t,e){return(nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function it(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=st(t);if(e){var o=st(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ot(this,n)}}function ot(t,e){return!e||"object"!==tt(e)&&"function"!=typeof e?rt(t):e}function rt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(a,t);var e,n,i,r=it(a);function a(t,e,n,i,s,l){var c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=r.call(this))._dragListener=n,c._layoutManager=i,c._contentItem=s,c._originalParent=l,c._area=null,c._lastValidArea=null,c._dragListener.on("drag",c._onDrag,rt(c)),c._dragListener.on("dragStop",c._onDrop,rt(c)),c.element=o()('<div class="lm_dragProxy"><div class="lm_header"><ul class="lm_tabs"><li class="lm_tab lm_active"><i class="lm_left"></i><span class="lm_title"></span><i class="lm_right"></i></li></ul></div><div class="lm_content"></div></div>'),l&&l._side&&(c._sided=l._sided,c.element.addClass("lm_"+l._side),["right","bottom"].indexOf(l._side)>=0&&c.element.find(".lm_content").after(c.element.find(".lm_header"))),c.element.css({left:t,top:e}),c.element.find(".lm_tab").attr("title",m(c._contentItem.config.title)),c.element.find(".lm_title").html(c._contentItem.config.title),c.childElementContainer=c.element.find(".lm_content"),c.childElementContainer.append(s.element),c._undisplayTree(),c._layoutManager._$calculateItemAreas(),c._setDimensions(),o()(document.body).append(c.element);var h=c._layoutManager.container.offset();return c._minX=h.left,c._minY=h.top,c._maxX=c._layoutManager.container.width()+c._minX,c._maxY=c._layoutManager.container.height()+c._minY,c._width=c.element.width(),c._height=c.element.height(),c._setDropPosition(t,e),c}return e=a,(n=[{key:"_onDrag",value:function(t,e,n){var i=(n=s(n)).pageX,o=n.pageY;(i>this._minX&&i<this._maxX&&o>this._minY&&o<this._maxY||!0!==this._layoutManager.config.settings.constrainDragToContainer)&&this._setDropPosition(i,o)}},{key:"_setDropPosition",value:function(t,e){this.element.css({left:t,top:e}),this._area=this._layoutManager._$getArea(t,e),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem._$highlightDropZone(t,e,this._area))}},{key:"_onDrop",value:function(){this._updateTree(),this._layoutManager.dropTargetIndicator.hide(),null!==this._area?this._area.contentItem._$onDrop(this._contentItem,this._area):null!==this._lastValidArea?this._lastValidArea.contentItem._$onDrop(this._contentItem,this._lastValidArea):this._originalParent?this._originalParent.addChild(this._contentItem):this._contentItem._$destroy(),this.element.remove(),this._layoutManager.emit("itemDropped",this._contentItem)}},{key:"_undisplayTree",value:function(){this._contentItem.parent&&this._contentItem.parent.undisplayChild(this._contentItem)}},{key:"_updateTree",value:function(){this._contentItem.parent&&this._contentItem.parent.removeChild(this._contentItem,!0),this._contentItem._$setParent(this)}},{key:"_setDimensions",value:function(){var t=this._layoutManager.config.dimensions,e=t.dragProxyWidth,n=t.dragProxyHeight;this.element.width(e),this.element.height(n),e-=this._sided?t.headerHeight:0,n-=this._sided?0:t.headerHeight,this.childElementContainer.width(e),this.childElementContainer.height(n),this._contentItem.element.width(e),this._contentItem.element.height(n),this._contentItem.callDownwards("_$show"),this._contentItem.callDownwards("setSize")}}])&&et(e.prototype,n),i&&et(e,i),a}(p);function lt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ct=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.header=e,this.contentItem=n,this.element=o()('<li class="lm_tab"><i class="lm_left"></i><span class="lm_title"></span><div class="lm_close_tab"></div><i class="lm_right"></i></li>'),this.titleElement=this.element.find(".lm_title"),this.closeElement=this.element.find(".lm_close_tab"),this.closeElement[n.config.isClosable?"show":"hide"](),this.isActive=!1,this.setTitle(n.config.title),this.contentItem.on("titleChanged",this.setTitle,this),this._layoutManager=this.contentItem.layoutManager,!0===this._layoutManager.config.settings.reorderEnabled&&!0===n.config.reorderEnabled&&(this._dragListener=new Q(this.element),this._dragListener.on("dragStart",this._onDragStart,this),this.contentItem.on("destroy",this._dragListener.destroy,this._dragListener)),this._onTabClickFn=f(this._onTabClick,this),this._onCloseClickFn=f(this._onCloseClick,this),this.element.on("mousedown touchstart",this._onTabClickFn),this.contentItem.config.isClosable?(this.closeElement.on("click touchstart",this._onCloseClickFn),this.closeElement.on("mousedown",this._onCloseMousedown)):this.closeElement.remove(),this.contentItem.tab=this,this.contentItem.emit("tab",this),this.contentItem.layoutManager.emit("tabCreated",this),this.contentItem.isComponent&&(this.contentItem.container.tab=this,this.contentItem.container.emit("tab",this))}var e,n,i;return e=t,(n=[{key:"setTitle",value:function(t){this.element.attr("title",m(t)),this.titleElement.html(t)}},{key:"setActive",value:function(t){t!==this.isActive&&(this.isActive=t,t?this.element.addClass("lm_active"):this.element.removeClass("lm_active"))}},{key:"_$destroy",value:function(){this.element.off("mousedown touchstart",this._onTabClickFn),this.closeElement.off("click touchstart",this._onCloseClickFn),this._dragListener&&(this.contentItem.off("destroy",this._dragListener.destroy,this._dragListener),this._dragListener.off("dragStart",this._onDragStart),this._dragListener=null),this.element.remove()}},{key:"_onDragStart",value:function(t,e){if(!this.header._canDestroy)return null;!0===this.contentItem.parent.isMaximised&&this.contentItem.parent.toggleMaximise(),new at(t,e,this._dragListener,this._layoutManager,this.contentItem,this.header.parent)}},{key:"_onTabClick",value:function(t){0===t.button||"touchstart"===t.type?this.header.parent.setActiveContentItem(this.contentItem):1===t.button&&this.contentItem.config.isClosable&&this._onCloseClick(t)}},{key:"_onCloseClick",value:function(t){t.stopPropagation(),this.header._canDestroy&&this.header.parent.removeChild(this.contentItem)}},{key:"_onCloseMousedown",value:function(t){t.stopPropagation()}}])&&lt(e.prototype,n),i&&lt(e,i),t}();function ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ut=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._header=e,this.element=o()('<li class="'+i+'" title="'+n+'"></li>'),this._header.on("destroy",this._$destroy,this),this._action=r,this.element.on("click touchstart",this._action),this._header.controlsContainer.append(this.element)}var e,n,i;return e=t,(n=[{key:"_$destroy",value:function(){this.element.off(),this.element.remove()}}])&&ht(e.prototype,n),i&&ht(e,i),t}();function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=gt(t);if(e){var o=gt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return yt(this,n)}}function yt(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?_t(t):e}function _t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vt=['<div class="lm_header">','<ul class="lm_tabs"></ul>','<ul class="lm_controls"></ul>','<ul class="lm_tabdropdown_list"></ul>',"</div>"].join(""),bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(s,t);var e,n,i,r=pt(s);function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(n=r.call(this)).layoutManager=t,n.element=o()(vt),!0===n.layoutManager.config.settings.selectionEnabled&&(n.element.addClass("lm_selectable"),n.element.on("click touchstart",f(n._onHeaderClick,_t(n)))),n.tabsContainer=n.element.find(".lm_tabs"),n.tabDropdownContainer=n.element.find(".lm_tabdropdown_list"),n.tabDropdownContainer.hide(),n.controlsContainer=n.element.find(".lm_controls"),n.parent=e,n.parent.on("resize",n._updateTabSizes,_t(n)),n.tabs=[],n.tabsMarkedForRemoval=[],n.activeContentItem=null,n.closeButton=null,n.dockButton=null,n.tabDropdownButton=null,n.hideAdditionalTabsDropdown=f(n._hideAdditionalTabsDropdown,_t(n)),o()(document).mouseup(n.hideAdditionalTabsDropdown),n._lastVisibleTabIndex=-1,n._tabControlOffset=n.layoutManager.config.settings.tabControlOffset,n._createControls(),n}return e=s,(n=[{key:"createTab",value:function(t,e){var n,i;for(i=0;i<this.tabs.length;i++)if(this.tabs[i].contentItem===t)return;if(n=new ct(this,t),0===this.tabs.length)return this.tabs.push(n),void this.tabsContainer.append(n.element);void 0===e&&(e=this.tabs.length),e>0?this.tabs[e-1].element.after(n.element):this.tabs[0].element.before(n.element),this.tabs.splice(e,0,n),this._updateTabSizes()}},{key:"removeTab",value:function(t){for(var e=0;e<this.tabs.length;e++)if(this.tabs[e].contentItem===t)return this.tabs[e]._$destroy(),void this.tabs.splice(e,1);for(e=0;e<this.tabsMarkedForRemoval.length;e++)if(this.tabsMarkedForRemoval[e].contentItem===t)return this.tabsMarkedForRemoval[e]._$destroy(),void this.tabsMarkedForRemoval.splice(e,1);throw new Error("contentItem is not controlled by this header")}},{key:"hideTab",value:function(t){for(var e=0;e<this.tabs.length;e++)if(this.tabs[e].contentItem===t)return this.tabs[e].element.hide(),this.tabsMarkedForRemoval.push(this.tabs[e]),void this.tabs.splice(e,1);throw new Error("contentItem is not controlled by this header")}},{key:"setActiveContentItem",value:function(t){var e,n,i,o;if(this.activeContentItem!==t){for(e=0;e<this.tabs.length;e++)i=this.tabs[e].contentItem===t,this.tabs[e].setActive(i),!0===i&&(this.activeContentItem=t,this.parent.config.activeItemIndex=e);if(this.layoutManager.config.settings.reorderOnTabMenuClick&&-1!==this._lastVisibleTabIndex&&this.parent.config.activeItemIndex>this._lastVisibleTabIndex){for(o=this.tabs[this.parent.config.activeItemIndex],n=this.parent.config.activeItemIndex;n>0;n--)this.tabs[n]=this.tabs[n-1];this.tabs[0]=o,this.parent.config.activeItemIndex=0}this._updateTabSizes(),this.parent.emitBubblingEvent("stateChanged")}}},{key:"position",value:function(t){var e=this.parent._header.show;if(this.parent._docker&&this.parent._docker.docked)throw new Error("Can't change header position in docked stack");return e&&!this.parent._side&&(e="top"),void 0!==t&&this.parent._header.show!=t&&(this.parent._header.show=t,this.parent.config.header?this.parent.config.header.show=t:this.parent.config.header={show:t},this.parent._setupHeaderPosition()),e}},{key:"_$setClosable",value:function(t){return this._canDestroy=t||this.tabs.length>1,!(!this.closeButton||!this._isClosable()||(this.closeButton.element[t?"show":"hide"](),0))}},{key:"_setDockable",value:function(t){return!!(this.dockButton&&this.parent._header&&this.parent._header.dock)&&(this.dockButton.element.toggle(!!t),!0)}},{key:"_$destroy",value:function(){this.emit("destroy",this);for(var t=0;t<this.tabs.length;t++)this.tabs[t]._$destroy();o()(document).off("mouseup",this.hideAdditionalTabsDropdown),this.element.remove()}},{key:"_getHeaderSetting",value:function(t){if(t in this.parent._header)return this.parent._header[t]}},{key:"_createControls",value:function(){var t,e,n,i,o,r,s,a,l;if(l=f(this._showAdditionalTabsDropdown,this),a=this.layoutManager.config.labels.tabDropdown,this.tabDropdownButton=new ut(this,a,"lm_tabdropdown",l),this.tabDropdownButton.element.hide(),this.parent._header&&this.parent._header.dock){var c=f(this.parent.dock,this.parent);n=this._getHeaderSetting("dock"),this.dockButton=new ut(this,n,"lm_dock",c)}this._getHeaderSetting("popout")&&(e=f(this._onPopoutClick,this),n=this._getHeaderSetting("popout"),new ut(this,n,"lm_popout",e)),this._getHeaderSetting("maximise")&&(r=f(this.parent.toggleMaximise,this.parent),i=this._getHeaderSetting("maximise"),o=this._getHeaderSetting("minimise"),s=new ut(this,i,"lm_maximise",r),this.parent.on("maximised",(function(){s.element.attr("title",o)})),this.parent.on("minimised",(function(){s.element.attr("title",i)}))),this._isClosable()&&(t=f(this.parent.remove,this.parent),n=this._getHeaderSetting("close"),this.closeButton=new ut(this,n,"lm_close",t))}},{key:"_showAdditionalTabsDropdown",value:function(){this.tabDropdownContainer.show()}},{key:"_hideAdditionalTabsDropdown",value:function(t){this.tabDropdownContainer.hide()}},{key:"_isClosable",value:function(){return this.parent.config.isClosable&&this.layoutManager.config.settings.showCloseIcon}},{key:"_onPopoutClick",value:function(){!0===this.layoutManager.config.settings.popoutWholeStack?this.parent.popout():this.activeContentItem.popout()}},{key:"_onHeaderClick",value:function(t){t.target===this.element[0]&&this.parent.select()}},{key:"_updateTabSizes",value:function(t){if(0!==this.tabs.length){this.tabDropdownButton.element.toggle(!0===t);var e=function(t){return t?"width":"height"};this.element.css(e(!this.parent._sided),""),this.element[e(this.parent._sided)](this.layoutManager.config.dimensions.headerHeight);var n,i,o,r,s=this.element.outerWidth()-this.controlsContainer.outerWidth()-this._tabControlOffset,a=0,l=0,c=0,h=this.layoutManager.config.settings.tabOverlapAllowance,u=!1,f=this.activeContentItem?this.tabs.indexOf(this.activeContentItem.tab):0,d=this.tabs[f];for(this.parent._sided&&(s=this.element.outerHeight()-this.controlsContainer.outerHeight()-this._tabControlOffset),this._lastVisibleTabIndex=-1,i=0;i<this.tabs.length;i++)if(n=this.tabs[i].element,this.tabsContainer.append(n),a+=n.outerWidth()+parseInt(n.css("margin-right"),10),(l=f<=i?a:a+d.element.outerWidth()+parseInt(d.element.css("margin-right"),10))>s){if(u)i===f&&(n.css({"z-index":"auto","margin-left":""}),this.tabsContainer.append(n));else if((c=f>0&&f<=i?(l-s)/(i-1):(l-s)/i)<h){for(o=0;o<=i;o++)r=o!==f&&0!==o?"-"+c+"px":"",this.tabs[o].element.css({"z-index":i-o,"margin-left":r});this._lastVisibleTabIndex=i,this.tabsContainer.append(n)}else u=!0;if(u&&i!==f){if(!t)return void this._updateTabSizes(!0);n.css({"z-index":"auto","margin-left":""}),this.tabDropdownContainer.append(n)}}else this._lastVisibleTabIndex=i,n.css({"z-index":"auto","margin-left":""}),this.tabsContainer.append(n)}}}])&&dt(e.prototype,n),i&&dt(e,i),s}(p);function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Dt(t);if(e){var o=Dt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return St(this,n)}}function St(t,e){return!e||"object"!==wt(e)&&"function"!=typeof e?xt(t):e}function xt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dt(t){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ct(t,e)}(s,t);var e,n,i,r=kt(s);function s(t,e,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(i=r.call(this,t,e,n)).element=o()('<div class="lm_item lm_stack"></div>'),i._activeContentItem=null;var a=t.config;return i._header={show:!0===a.settings.hasHeaders&&!1!==e.hasHeaders,popout:a.settings.showPopoutIcon&&a.labels.popout,maximise:a.settings.showMaximiseIcon&&a.labels.maximise,close:a.settings.showCloseIcon&&a.labels.close,minimise:a.labels.minimise},a.header&&l(i._header,a.header),e.header&&l(i._header,e.header),e.content&&e.content[0]&&e.content[0].header&&l(i._header,e.content[0].header),i._dropZones={},i._dropSegment=null,i._contentAreaDimensions=null,i._dropIndex=null,i.isStack=!0,i.childElementContainer=o()('<div class="lm_items"></div>'),i.header=new bt(t,xt(i)),i.element.on("mouseleave mouseenter",f((function(t){this._docker&&this._docker.docked&&this.childElementContainer[this._docker.dimension]("mouseenter"==t.type?this._docker.realSize:0)}),xt(i))),i.element.append(i.header.element),i.element.append(i.childElementContainer),i._setupHeaderPosition(),i._$validateClosability(),i}return e=s,(n=[{key:"dock",value:function(t){this._header.dock&&this.parent instanceof zt&&this.parent.dock(this,t)}},{key:"setSize",value:function(){if("none"!==this.element.css("display")){var t=this._docker&&this._docker.docked,e={width:this.element.width(),height:this.element.height()};this._header.show&&(e[this._sided?"width":"height"]-=this.layoutManager.config.dimensions.headerHeight),t&&(e[this._docker.dimension]=this._docker.realSize),t&&"height"!=this._docker.dimension||this.childElementContainer.width(e.width),t&&"width"!=this._docker.dimension||this.childElementContainer.height(e.height);for(var n=0;n<this.contentItems.length;n++)this.contentItems[n].element.width(e.width),this.contentItems[n].element.height(e.height);this.emit("resize"),this.emitBubblingEvent("stateChanged")}}},{key:"_$init",value:function(){var t,e;if(!0!==this.isInitialised){for(X.prototype._$init.call(this),t=0;t<this.contentItems.length;t++)this.header.createTab(this.contentItems[t]),this.contentItems[t]._$hide();this.contentItems.length>0&&((e=this.contentItems[this.config.activeItemIndex||0])||(e=this.contentItems[0]),this.setActiveContentItem(e)),this._$validateClosability(),this.parent instanceof zt&&this.parent._validateDocking()}}},{key:"setActiveContentItem",value:function(t){if(this._activeContentItem!==t){if(-1===h(t,this.contentItems))throw new Error("contentItem is not a child of this stack");null!==this._activeContentItem&&this._activeContentItem._$hide(),this._activeContentItem=t,this.header.setActiveContentItem(t),t._$show(),this.emit("activeContentItemChanged",t),this.layoutManager.emit("activeContentItemChanged",t),this.emitBubblingEvent("stateChanged")}}},{key:"getActiveContentItem",value:function(){return this.header.activeContentItem}},{key:"addChild",value:function(t,e){e>this.contentItems.length&&(e-=1),t=this.layoutManager._$normalizeContentItem(t,this),X.prototype.addChild.call(this,t,e),this.childElementContainer.append(t.element),this.header.createTab(t,e),this.setActiveContentItem(t),this.callDownwards("setSize"),this._$validateClosability(),this.parent instanceof zt&&this.parent._validateDocking(),this.emitBubblingEvent("stateChanged")}},{key:"removeChild",value:function(t,e){var n=h(t,this.contentItems);if(X.prototype.removeChild.call(this,t,e),this.header.removeTab(t),this.header.activeContentItem===t)this.contentItems.length>0?this.setActiveContentItem(this.contentItems[Math.max(n-1,0)]):this._activeContentItem=null;else if(this.config.activeItemIndex>=this.contentItems.length&&this.contentItems.length>0){var i=h(this.getActiveContentItem(),this.contentItems);this.config.activeItemIndex=Math.max(i,0)}this._$validateClosability(),this.parent instanceof zt&&this.parent._validateDocking(),this.emitBubblingEvent("stateChanged")}},{key:"undisplayChild",value:function(t){if(this.contentItems.length>1){var e=h(t,this.contentItems);t._$hide&&t._$hide(),this.setActiveContentItem(this.contentItems[0===e?e+1:e-1])}else this.header.hideTab(t),t._$hide&&t._$hide(),X.prototype.undisplayChild.call(this,t),this.parent instanceof zt&&this.parent._validateDocking();this.emitBubblingEvent("stateChanged")}},{key:"_$validateClosability",value:function(){var t,e,n;for(t=this.header._isClosable(),n=0,e=this.contentItems.length;n<e&&t;n++)t=this.contentItems[n].config.isClosable;this.header._$setClosable(t)}},{key:"_$destroy",value:function(){X.prototype._$destroy.call(this),this.header._$destroy(),this.element.off("mouseenter mouseleave")}},{key:"_$onDrop",value:function(t){if("header"===this._dropSegment)return this._resetHeaderDropZone(),void this.addChild(t,this._dropIndex);if("body"!==this._dropSegment){var e,n,i,o="top"===this._dropSegment||"bottom"===this._dropSegment,r="left"===this._dropSegment||"right"===this._dropSegment,s="top"===this._dropSegment||"left"===this._dropSegment,a=o&&this.parent.isColumn||r&&this.parent.isRow,l=o?"column":"row",c=o?"height":"width";t.isComponent&&((n=this.layoutManager.createContentItem({type:"stack",header:t.config.header||{}},this))._$init(),n.addChild(t),t=n),"row"!==t.config.type&&"column"!==t.config.type||((n=this.layoutManager.createContentItem({type:"stack"},this)).addChild(t),t=n),a?(e=h(this,this.parent.contentItems),this.parent.addChild(t,s?e:e+1,!0),this.config[c]*=.5,t.config[c]=this.config[c],this.parent.callDownwards("setSize")):(l=o?"column":"row",i=this.layoutManager.createContentItem({type:l},this),this.parent.replaceChild(this,i),i.addChild(t,s?0:void 0,!0),i.addChild(this,s?void 0:0,!0),this.config[c]=50,t.config[c]=50,i.callDownwards("setSize")),this.parent._validateDocking()}else this.addChild(t)}},{key:"_$highlightDropZone",value:function(t,e){var n,i;for(n in this._contentAreaDimensions)if((i=this._contentAreaDimensions[n].hoverArea).x1<t&&i.x2>t&&i.y1<e&&i.y2>e)return void("header"===n?(this._dropSegment="header",this._highlightHeaderDropZone(this._sided?e:t)):(this._resetHeaderDropZone(),this._highlightBodyDropZone(n)))}},{key:"_$getArea",value:function(){if("none"===this.element.css("display"))return null;var t=X.prototype._$getArea,e=t.call(this,this.header.element),n=t.call(this,this.childElementContainer),i=n.x2-n.x1,o=n.y2-n.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}},this._activeContentItem&&!1===this._activeContentItem.isComponent?e:0===this.contentItems.length?(this._contentAreaDimensions.body={hoverArea:{x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2},highlightArea:{x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2}},t.call(this,this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:n.x1,y1:n.y1,x2:n.x1+.25*i,y2:n.y2},highlightArea:{x1:n.x1,y1:n.y1,x2:n.x1+.5*i,y2:n.y2}},this._contentAreaDimensions.top={hoverArea:{x1:n.x1+.25*i,y1:n.y1,x2:n.x1+.75*i,y2:n.y1+.5*o},highlightArea:{x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y1+.5*o}},this._contentAreaDimensions.right={hoverArea:{x1:n.x1+.75*i,y1:n.y1,x2:n.x2,y2:n.y2},highlightArea:{x1:n.x1+.5*i,y1:n.y1,x2:n.x2,y2:n.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:n.x1+.25*i,y1:n.y1+.5*o,x2:n.x1+.75*i,y2:n.y2},highlightArea:{x1:n.x1,y1:n.y1+.5*o,x2:n.x2,y2:n.y2}},t.call(this,this.element))}},{key:"_highlightHeaderDropZone",value:function(t){var e,n,i,o,r,s,a,l,c=this.header.tabs.length,h=!1;if(0===c)return a=this.header.element.offset(),void this.layoutManager.dropTargetIndicator.highlightArea({x1:a.left,x2:a.left+100,y1:a.top+this.header.element.height()-20,y2:a.top+this.header.element.height()});for(e=0;e<c;e++)if(r=(n=this.header.tabs[e].element).offset(),this._sided?(o=r.top,i=r.left,l=n.height()):(o=r.left,i=r.top,l=n.width()),t>o&&t<o+l){h=!0;break}if(!(!1===h&&t<o))if(t<o+l/2?(this._dropIndex=e,n.before(this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(e+1,c),n.after(this.layoutManager.tabDropPlaceholder)),this._sided){var u=this.layoutManager.tabDropPlaceholder.offset().top;this.layoutManager.dropTargetIndicator.highlightArea({x1:i,x2:i+n.innerHeight(),y1:u,y2:u+this.layoutManager.tabDropPlaceholder.width()})}else s=this.layoutManager.tabDropPlaceholder.offset().left,this.layoutManager.dropTargetIndicator.highlightArea({x1:s,x2:s+this.layoutManager.tabDropPlaceholder.width(),y1:i,y2:i+n.innerHeight()})}},{key:"_resetHeaderDropZone",value:function(){this.layoutManager.tabDropPlaceholder.remove()}},{key:"toggleMaximise",value:function(t){this.isMaximised||this.dock(!1),X.prototype.toggleMaximise.call(this,t)}},{key:"_setupHeaderPosition",value:function(){var t=["right","left","bottom"].indexOf(this._header.show)>=0&&this._header.show;if(this.header.element.toggle(!!this._header.show),this._side=t,this._sided=["right","left"].indexOf(this._side)>=0,this.element.removeClass("lm_left lm_right lm_bottom"),this._side&&this.element.addClass("lm_"+this._side),this.element.find(".lm_header").length&&this.childElementContainer){var e=["right","bottom"].indexOf(this._side)>=0?"before":"after";this.header.element[e](this.childElementContainer),this.callDownwards("setSize")}}},{key:"_highlightBodyDropZone",value:function(t){var e=this._contentAreaDimensions[t].highlightArea;this.layoutManager.dropTargetIndicator.highlightArea(e),this._dropSegment=t}}])&&It(e.prototype,n),i&&It(e,i),s}(X);function Pt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ot=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isVertical=e,this._size=n,this._grabSize=i<n?n:i,this.element=this._createElement(),this._dragListener=new Q(this.element)}var e,n,i;return e=t,(n=[{key:"on",value:function(t,e,n){this._dragListener.on(t,e,n)}},{key:"_$destroy",value:function(){this.element.remove()}},{key:"_createElement",value:function(){var t=o()('<div class="lm_drag_handle"></div>'),e=o()('<div class="lm_splitter"></div>');e.append(t);var n=this._grabSize-this._size,i=n/2;return this._isVertical?(t.css("top",-i),t.css("height",this._size+n),e.addClass("lm_vertical"),e.height(this._size)):(t.css("left",-i),t.css("width",this._size+n),e.addClass("lm_horizontal"),e.width(this._size)),e}}])&&Pt(e.prototype,n),i&&Pt(e,i),t}();function Mt(t){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rt(t,e){return(Rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=$t(t);if(e){var o=$t(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return jt(this,n)}}function jt(t,e){return!e||"object"!==Mt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rt(t,e)}(s,t);var e,n,i,r=At(s);function s(t,e,n,i){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(a=r.call(this,e,n,i)).isRow=!t,a.isColumn=t,a.element=o()('<div class="lm_item lm_'+(t?"column":"row")+'"></div>'),a.childElementContainer=a.element,a._splitterSize=e.config.dimensions.borderWidth,a._splitterGrabSize=e.config.dimensions.borderGrabWidth,a._isColumn=t,a._dimension=t?"height":"width",a._splitter=[],a._splitterPosition=null,a._splitterMinPosition=null,a._splitterMaxPosition=null,a}return e=s,(n=[{key:"addChild",value:function(t,e,n){var i,o,r,s;if(t=this.layoutManager._$normalizeContentItem(t,this),void 0===e&&(e=this.contentItems.length),this.contentItems.length>0?(s=this._createSplitter(Math.max(0,e-1)).element,e>0?(this.contentItems[e-1].element.after(s),s.after(t.element),this._isDocked(e-1)&&(this._splitter[e-1].element.hide(),this._splitter[e].element.show())):(this.contentItems[0].element.before(s),s.before(t.element))):this.childElementContainer.append(t.element),X.prototype.addChild.call(this,t,e),i=1/this.contentItems.length*100,!0!==n){for(r=0;r<this.contentItems.length;r++)this.contentItems[r]===t?t.config[this._dimension]=i:(o=this.contentItems[r].config[this._dimension]*=(100-i)/100,this.contentItems[r].config[this._dimension]=o);this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"),this._validateDocking()}else this.emitBubblingEvent("stateChanged")}},{key:"undisplayChild",value:function(t){var e,n=t.config[this._dimension],i=h(t,this.contentItems),o=Math.max(i-1,0);if(-1===i)throw new Error("Can't undisplay child. ContentItem is not child of this Row or Column");this._splitter[o]&&this._splitter[o].element.hide(),o<this._splitter.length&&this._isDocked(o)&&this._splitter[o].element.hide();var r=this._isDocked();for(e=0;e<this.contentItems.length;e++)this.contentItems[e]!==t?this._isDocked(e)||(this.contentItems[e].config[this._dimension]+=n/(this.contentItems.length-1-r)):this.contentItems[e].config[this._dimension]=0;1===this.contentItems.length&&X.prototype.undisplayChild.call(this,t),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")}},{key:"removeChild",value:function(t,e){var n,i,o=t.config[this._dimension],r=h(t,this.contentItems),s=Math.max(r-1,0);if(-1===r)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");this._splitter[s]&&(this._splitter[s]._$destroy(),this._splitter.splice(s,1)),s<this._splitter.length&&this._isDocked(s)&&this._splitter[s].element.hide();var a=this._isDocked();for(n=0;n<this.contentItems.length;n++)this.contentItems[n]!==t&&(this._isDocked(n)||(this.contentItems[n].config[this._dimension]+=o/(this.contentItems.length-1-a)));X.prototype.removeChild.call(this,t,e),1===this.contentItems.length&&!0===this.config.isClosable?(i=this.contentItems[0],this.contentItems=[],this.parent.replaceChild(this,i,!0),this._validateDocking(this.parent)):(this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"),this._validateDocking())}},{key:"replaceChild",value:function(t,e){var n=t.config[this._dimension];X.prototype.replaceChild.call(this,t,e),e.config[this._dimension]=n,this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")}},{key:"setSize",value:function(){this.contentItems.length>0&&(this._calculateRelativeSizes(),this._setAbsoluteSizes()),this.emitBubblingEvent("stateChanged"),this.emit("resize")}},{key:"dock",value:function(t,e,n){if(1===this.contentItems.length)throw new Error("Can't dock child when it single");var i=t.config[this._dimension],o=this.layoutManager.config.dimensions.headerHeight,r=h(t,this.contentItems),s=Math.max(r-1,0);if(-1===r)throw new Error("Can't dock child. ContentItem is not child of this Row or Column");var a,l=t._docker&&t._docker.docked;if(void 0===e||e!=l){if(l){for(this._splitter[s].element.show(),a=0;a<this.contentItems.length;a++){var c=t._docker.size;this.contentItems[a]===t?t.config[this._dimension]=c:(itemSize=this.contentItems[a].config[this._dimension]*=(100-c)/100,this.contentItems[a].config[this._dimension]=itemSize)}t._docker={docked:!1}}else{if(this.contentItems.length-this._isDocked()<2)throw new Error("Can't dock child when it is last in "+this.config.type);var u={column:{first:"top",last:"bottom"},row:{first:"left",last:"right"}}[this.config.type][r?"last":"first"];t.header.position()!=u&&t.header.position(u),this._splitter[s]&&this._splitter[s].element.hide();var f=this._isDocked();for(a=0;a<this.contentItems.length;a++)this.contentItems[a]!==t?this._isDocked(a)||(this.contentItems[a].config[this._dimension]+=i/(this.contentItems.length-1-f)):this.contentItems[a].config[this._dimension]=0;t._docker={dimension:this._dimension,size:i,realSize:t.element[this._dimension]()-o,docked:!0},n&&t.childElementContainer[this._dimension](0)}t.element.toggleClass("lm_docked",t._docker.docked),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"),this._validateDocking()}}},{key:"_$init",value:function(){if(!0!==this.isInitialised){var t;for(X.prototype._$init.call(this),t=0;t<this.contentItems.length-1;t++)this.contentItems[t].element.after(this._createSplitter(t).element);for(t=0;t<this.contentItems.length;t++)this.contentItems[t]._header&&this.contentItems[t]._header.docked&&this.dock(this.contentItems[t],!0,!0)}}},{key:"_setAbsoluteSizes",value:function(){var t,e=this._calculateAbsoluteSizes();for(t=0;t<this.contentItems.length;t++)e.additionalPixel-t>0&&e.itemSizes[t]++,this._isColumn?(this.contentItems[t].element.width(e.totalWidth),this.contentItems[t].element.height(e.itemSizes[t])):(this.contentItems[t].element.width(e.itemSizes[t]),this.contentItems[t].element.height(e.totalHeight))}},{key:"_calculateAbsoluteSizes",value:function(){var t,e,n=(this.contentItems.length-1)*this._splitterSize,i=this.layoutManager.config.dimensions.headerHeight,o=this.element.width(),r=this.element.height(),s=0,a=[];for(this._isColumn?r-=n:o-=n,t=0;t<this.contentItems.length;t++)this._isDocked(t)&&(this._isColumn?r-=i-this._splitterSize:o-=i-this._splitterSize);for(t=0;t<this.contentItems.length;t++)e=this._isColumn?Math.floor(r*(this.contentItems[t].config.height/100)):Math.floor(o*(this.contentItems[t].config.width/100)),this._isDocked(t)&&(e=i),s+=e,a.push(e);return{itemSizes:a,additionalPixel:Math.floor((this._isColumn?r:o)-s),totalWidth:o,totalHeight:r}}},{key:"_calculateRelativeSizes",value:function(){var t,e=0,n=[],i=this._isColumn?"height":"width";for(t=0;t<this.contentItems.length;t++)void 0!==this.contentItems[t].config[i]?e+=this.contentItems[t].config[i]:n.push(this.contentItems[t]);if(100!==Math.round(e))if(Math.round(e)<100&&n.length>0){for(t=0;t<n.length;t++)n[t].config[i]=(100-e)/n.length;this._respectMinItemWidth()}else{if(Math.round(e)>100)for(t=0;t<n.length;t++)n[t].config[i]=50,e+=50;for(t=0;t<this.contentItems.length;t++)this.contentItems[t].config[i]=this.contentItems[t].config[i]/e*100;this._respectMinItemWidth()}else this._respectMinItemWidth()}},{key:"_respectMinItemWidth",value:function(){var t,e,n,i,o=this.layoutManager.config.dimensions&&this.layoutManager.config.dimensions.minItemWidth||0,r=[],s=0,a=0,l=0,c=0,h=[];if(!(this._isColumn||!o||this.contentItems.length<=1)){t=this._calculateAbsoluteSizes();for(var u=0;u<this.contentItems.length;u++)this.contentItems[u],(c=t.itemSizes[u])<o?(a+=o-c,i={width:o}):(s+=c-o,i={width:c},r.push(i)),h.push(i);if(!(0===a||a>s)){for(e=a/s,l=a,u=0;u<r.length;u++)i=r[u],l-=n=Math.round((i.width-o)*e),i.width-=n;for(0!==l&&(h[h.length-1].width-=l),u=0;u<this.contentItems.length;u++)this.contentItems[u].config.width=h[u].width/t.totalWidth*100}}}},{key:"_createSplitter",value:function(t){var e;return(e=new Ot(this._isColumn,this._splitterSize,this._splitterGrabSize)).on("drag",f(this._onSplitterDrag,this,[e]),this),e.on("dragStop",f(this._onSplitterDragStop,this,[e]),this),e.on("dragStart",f(this._onSplitterDragStart,this,[e]),this),this._splitter.splice(t,0,e),e}},{key:"_getItemsForSplitter",value:function(t){var e=h(t,this._splitter);return{before:this.contentItems[e],after:this.contentItems[e+1]}}},{key:"_isDocked",value:function(t){if(void 0===t){for(var e=0,n=0;n<this.contentItems.length;++n)this._isDocked(n)&&e++;return e}if(t<this.contentItems.length)return this.contentItems[t]._docker&&this.contentItems[t]._docker.docked}},{key:"_validateDocking",value:function(t){for(var e=(t=t||this).contentItems.length-t._isDocked()>1,n=0;n<t.contentItems.length;++n)t.contentItems[n]instanceof Et&&(t.contentItems[n].header._setDockable(t._isDocked(n)||e),t.contentItems[n].header._$setClosable(e))}},{key:"_getMinimumDimensions",value:function(t){for(var e=0,n=0,i=0;i<t.length;++i)e=Math.max(t[i].minWidth||0,e),n=Math.max(t[i].minHeight||0,n);return{horizontal:e,vertical:n}}},{key:"_onSplitterDragStart",value:function(t){var e=this._getItemsForSplitter(t),n=this.layoutManager.config.dimensions[this._isColumn?"minItemHeight":"minItemWidth"],i=this._getMinimumDimensions(e.before.config.content),o=this._isColumn?i.vertical:i.horizontal,r=this._getMinimumDimensions(e.after.config.content),s=this._isColumn?r.vertical:r.horizontal;this._splitterPosition=0,this._splitterMinPosition=-1*(e.before.element[this._dimension]()-(o||n)),this._splitterMaxPosition=e.after.element[this._dimension]()-(s||n)}},{key:"_onSplitterDrag",value:function(t,e,n){var i=this._isColumn?n:e;i>this._splitterMinPosition&&i<this._splitterMaxPosition&&(this._splitterPosition=i,t.element.css(this._isColumn?"top":"left",i))}},{key:"_onSplitterDragStop",value:function(t){var e=this._getItemsForSplitter(t),n=e.before.element[this._dimension](),i=e.after.element[this._dimension](),o=(this._splitterPosition+n)/(n+i),r=e.before.config[this._dimension]+e.after.config[this._dimension];e.before.config[this._dimension]=o*r,e.after.config[this._dimension]=(1-o)*r,t.element.css({top:0,left:0}),c(f(this.callDownwards,this,["setSize"]))}}])&&Tt(e.prototype,n),i&&Tt(e,i),s}(X);function Wt(t){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Nt(t);if(e){var o=Nt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Lt(this,n)}}function Lt(t,e){return!e||"object"!==Wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nt(t){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ut=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(s,t);var e,n,i,r=Ft(s);function s(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(i=r.call(this,t,e,null)).isRoot=!0,i.type="root",i.element=o()('<div class="lm_goldenlayout lm_item lm_root"></div>'),i.childElementContainer=i.element,i._containerElement=n,i._containerElement.append(i.element),i}return e=s,(n=[{key:"addChild",value:function(t){if(this.contentItems.length>0)throw new Error("Root node can only have a single child");t=this.layoutManager._$normalizeContentItem(t,this),this.childElementContainer.append(t.element),X.prototype.addChild.call(this,t),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")}},{key:"setSize",value:function(t,e){t=void 0===t?this._containerElement.width():t,e=void 0===e?this._containerElement.height():e,this.element.width(t),this.element.height(e),this.contentItems[0]&&(this.contentItems[0].element.width(t),this.contentItems[0].element.height(e))}},{key:"_$highlightDropZone",value:function(t,e,n){this.layoutManager.tabDropPlaceholder.remove(),X.prototype._$highlightDropZone.apply(this,arguments)}},{key:"_$onDrop",value:function(t,e){var n;if(t.isComponent&&((n=this.layoutManager.createContentItem({type:"stack",header:t.config.header||{}},this))._$init(),n.addChild(t),t=n),this.contentItems.length){"row"!==t.config.type&&"column"!==t.config.type||((n=this.layoutManager.createContentItem({type:"stack"},this)).addChild(t),t=n);var i="x"==e.side[0]?"row":"column",o="x"==e.side[0]?"width":"height",r="2"==e.side[1],s=this.contentItems[0];if(s instanceof zt&&s.type==i){var a=s.contentItems[r?0:s.contentItems.length-1];s.addChild(t,r?0:void 0,!0),a.config[o]*=.5,t.config[o]=a.config[o],s.callDownwards("setSize")}else{var l=this.layoutManager.createContentItem({type:i},this);this.replaceChild(s,l),l.addChild(t,r?0:void 0,!0),l.addChild(s,r?void 0:0,!0),s.config[o]=50,t.config[o]=50,l.callDownwards("setSize")}}else this.addChild(t)}}])&&Ht(e.prototype,n),i&&Ht(e,i),s}(X);function Xt(t){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=qt(t);if(e){var o=qt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Zt(this,n)}}function Zt(t,e){return!e||"object"!==Xt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(s,t);var e,n,i,r=Vt(s);function s(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(i=r.call(this)).width=null,i.height=null,i.title=t.componentName,i.parent=e,i.layoutManager=n,i.isHidden=!1,i._config=t,i._element=o()(['<div class="lm_item_container">','<div class="lm_content"></div>',"</div>"].join("")),i._contentElement=i._element.find(".lm_content"),i}return e=s,(n=[{key:"getElement",value:function(){return this._contentElement}},{key:"hide",value:function(){this.emit("hide"),this.isHidden=!0,this._element.hide()}},{key:"show",value:function(){this.emit("show"),this.isHidden=!1,this._element.show(),0==this.height&&0==this.width||this.emit("shown")}},{key:"setSize",value:function(t,e){for(var n,i,o,r,s=this.parent,a=this;!s.isColumn&&!s.isRow;)if(a=s,(s=s.parent).isRoot)return!1;for(n=("height"==(i=s.isColumn?"height":"width")?e:t)/(this[i]*(1/(a.config[i]/100)))*100,o=(a.config[i]-n)/(s.contentItems.length-1),r=0;r<s.contentItems.length;r++)s.contentItems[r]===a?s.contentItems[r].config[i]=n:s.contentItems[r].config[i]+=o;return s.callDownwards("setSize"),!0}},{key:"close",value:function(){this._config.isClosable&&(this.emit("close"),this.parent.close())}},{key:"getState",value:function(){return this._config.componentState}},{key:"extendState",value:function(t){this.setState(o.a.extend(!0,this.getState(),t))}},{key:"setState",value:function(t){this._config.componentState=t,this.parent.emitBubblingEvent("stateChanged")}},{key:"setTitle",value:function(t){this.parent.setTitle(t)}},{key:"_$setSize",value:function(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,o.a.zepto?this._contentElement.width(t):this._contentElement.outerWidth(t),o.a.zepto?this._contentElement.height(e):this._contentElement.outerHeight(e),this.emit("resize"))}}])&&Gt(e.prototype,n),i&&Gt(e,i),s}(p);function Kt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Qt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._reactComponent=null,this._originalComponentWillUpdate=null,this._container=e,this._initialState=n,this._reactClass=this._getReactClass(),this._container.on("open",this._render,this),this._container.on("destroy",this._destroy,this)}var e,n,i;return e=t,(n=[{key:"_render",value:function(){ReactDOM.render(this._getReactComponent(),this._container.getElement()[0])}},{key:"_gotReactComponent",value:function(t){null!==t&&(this._reactComponent=t,this._originalComponentWillUpdate=this._reactComponent.componentWillUpdate||function(){},this._reactComponent.componentWillUpdate=this._onUpdate.bind(this),this._container.getState()&&this._reactComponent.setState(this._container.getState()))}},{key:"_destroy",value:function(){ReactDOM.unmountComponentAtNode(this._container.getElement()[0]),this._container.off("open",this._render,this),this._container.off("destroy",this._destroy,this)}},{key:"_onUpdate",value:function(t,e){this._container.setState(e),this._originalComponentWillUpdate.call(this._reactComponent,t,e)}},{key:"_getReactClass",value:function(){var t,e=this._container._config.component;if(!e)throw new Error("No react component name. type: react-component needs a field `component`");if(!(t=this._container.layoutManager.getComponent(this._container._config)))throw new Error('React component "'+e+'" not found. Please register all components with GoldenLayout using `registerComponent(name, component)`');return t}},{key:"_getReactComponent",value:function(){var t={glEventHub:this._container.layoutManager.eventHub,glContainer:this._container,ref:this._gotReactComponent.bind(this)},e=o.a.extend(t,this._container._config.props);return React.createElement(this._reactClass,e)}}])&&Kt(e.prototype,n),i&&Kt(e,i),t}();function te(t){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ee(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ne(t,e){return(ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=se(t);if(e){var o=se(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return oe(this,n)}}function oe(t,e){return!e||"object"!==te(e)&&"function"!=typeof e?re(t):e}function re(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function se(t){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ae=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(s,t);var e,n,i,r=ie(s);function s(t,e,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),i=r.call(this,t,e,n);var a=t.isReactConfig(e)?Qt:t.getComponent(e),l=o.a.extend(!0,{},i.config.componentState||{});return l.componentName=i.config.componentName,i.componentName=i.config.componentName,""===i.config.title&&(i.config.title=i.config.componentName),i.isComponent=!0,i.container=new Jt(i.config,re(i),t),i.instance=new a(i.container,l),i.element=i.container._element,i}return e=s,(n=[{key:"close",value:function(){this.parent.removeChild(this)}},{key:"setSize",value:function(){"none"!==this.element.css("display")&&this.container._$setSize(this.element.width(),this.element.height())}},{key:"_$init",value:function(){X.prototype._$init.call(this),this.container.emit("open")}},{key:"_$hide",value:function(){this.container.hide(),X.prototype._$hide.call(this)}},{key:"_$show",value:function(){this.container.show(),X.prototype._$show.call(this)}},{key:"_$shown",value:function(){this.container.shown(),X.prototype._$shown.call(this)}},{key:"_$destroy",value:function(){this.container.emit("destroy",this),X.prototype._$destroy.call(this)}},{key:"_$getArea",value:function(){return null}}])&&ee(e.prototype,n),i&&ee(e,i),s}(X);function le(t){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ce(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=de(t);if(e){var o=de(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return fe(this,n)}}function fe(t,e){return!e||"object"!==le(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function de(t){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&he(t,e)}(s,t);var e,n,i,r=ue(s);function s(t,e,n,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(a=r.call(this)).isInitialised=!1,a._config=t,a._dimensions=e,a._parentId=n,a._indexInParent=i,a._layoutManager=o,a._popoutWindow=null,a._id=null,a._createWindow(),a}return e=s,(n=[{key:"toConfig",value:function(){if(!1===this.isInitialised)throw new Error("Can't create config, layout not yet initialised");return{dimensions:{width:this.getGlInstance().width,height:this.getGlInstance().height,left:this._popoutWindow.screenX||this._popoutWindow.screenLeft,top:this._popoutWindow.screenY||this._popoutWindow.screenTop},content:this.getGlInstance().toConfig().content,parentId:this._parentId,indexInParent:this._indexInParent}}},{key:"getGlInstance",value:function(){return this._popoutWindow.__glInstance}},{key:"getWindow",value:function(){return this._popoutWindow}},{key:"close",value:function(){if(this.getGlInstance())this.getGlInstance()._$closeWindow();else try{this.getWindow().close()}catch(t){}}},{key:"popIn",value:function(){var t,e;this._indexInParent,this._parentId&&(t=o.a.extend(!0,{},this.getGlInstance().toConfig()).content[0],(e=this._layoutManager.root.getItemsById(this._parentId)[0])||(e=this._layoutManager.root.contentItems.length>0?this._layoutManager.root.contentItems[0]:this._layoutManager.root)),e.addChild(t,this._indexInParent),this.close()}},{key:"_createWindow",value:function(){var t,e=this._createUrl(),n=Math.floor(1e6*Math.random()).toString(36),i=this._serializeWindowOptions({width:this._dimensions.width,height:this._dimensions.height,innerWidth:this._dimensions.width,innerHeight:this._dimensions.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=window.open(e,n,i),this._popoutWindow)o()(this._popoutWindow).on("load",f(this._positionWindow,this)).on("unload beforeunload",f(this._onClose,this)),t=setInterval(f((function(){this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this._onInitialised(),clearInterval(t))}),this),10);else if(!0===this._layoutManager.config.settings.blockedPopoutsThrowError){var r=new Error("Popout blocked");throw r.type="popoutBlocked",r}}},{key:"_serializeWindowOptions",value:function(t){var e,n=[];for(e in t)n.push(e+"="+t[e]);return n.join(",")}},{key:"_createUrl",value:function(){var t,e={content:this._config},n="gl-window-config-"+d();e=(new g).minifyConfig(e);try{localStorage.setItem(n,JSON.stringify(e))}catch(t){throw new Error("Error while writing to localStorage "+t.toString())}return 1===(t=document.location.href.split("?")).length?t[0]+"?gl-window="+n:document.location.href+"&gl-window="+n}},{key:"_positionWindow",value:function(){this._popoutWindow.moveTo(this._dimensions.left,this._dimensions.top),this._popoutWindow.focus()}},{key:"_onInitialised",value:function(){this.isInitialised=!0,this.getGlInstance().on("popIn",this.popIn,this),this.emit("initialised")}},{key:"_onClose",value:function(){setTimeout(f(this.emit,this,["closed"]),50)}}])&&ce(e.prototype,n),i&&ce(e,i),s}(p);function pe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ye=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._element=e,this._itemConfig=n,this._layoutManager=i,this._dragListener=null,this._createDragListener()}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){this._removeDragListener()}},{key:"_createDragListener",value:function(){this._removeDragListener(),this._dragListener=new Q(this._element),this._dragListener.on("dragStart",this._onDragStart,this),this._dragListener.on("dragStop",this._createDragListener,this)}},{key:"_onDragStart",value:function(t,e){var n=this._itemConfig;u(n)&&(n=n());var i=this._layoutManager._$normalizeContentItem(o.a.extend(!0,{},n)),r=new at(t,e,this._dragListener,this._layoutManager,i,null);this._layoutManager.transitionIndicator.transitionElements(this._element,r.element)}},{key:"_removeDragListener",value:function(){null!==this._dragListener&&this._dragListener.destroy()}}])&&pe(e.prototype,n),i&&pe(e,i),t}();function _e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ge=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=o()('<div class="lm_dropTargetIndicator"><div class="lm_inner"></div></div>'),o()(document.body).append(this.element)}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){this.element.remove()}},{key:"highlight",value:function(t,e,n,i){this.highlightArea({x1:t,y1:e,x2:n,y2:i})}},{key:"highlightArea",value:function(t){this.element.css({left:t.x1,top:t.y1,width:t.x2-t.x1,height:t.y2-t.y1}).show()}},{key:"hide",value:function(){this.element.hide()}}])&&_e(e.prototype,n),i&&_e(e,i),t}();function ve(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var be=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._element=o()('<div class="lm_transition_indicator"></div>'),o()(document.body).append(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){this._element.remove()}},{key:"transitionElements",value:function(t,e){}},{key:"_nextAnimationFrame",value:function(){var t,e=this._measure(this._toElement),n=(("function"==typeof Date.now?Date.now():(new Date).getTime())-this._animationStartTime)/this._totalAnimationDuration,i={};if(n>=1)this._element.hide();else{for(t in e.opacity=0,this._fromDimensions)i[t]=this._fromDimensions[t]+(e[t]-this._fromDimensions[t])*n;this._element.css(i),c(f(this._nextAnimationFrame,this))}}},{key:"_measure",value:function(t){var e=t.offset();return{left:e.left,top:e.top,width:t.outerWidth(),height:t.outerHeight()}}}])&&ve(e.prototype,n),i&&ve(e,i),t}(),we={openPopouts:[],settings:{hasHeaders:!0,constrainDragToContainer:!0,reorderEnabled:!0,selectionEnabled:!1,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,showPopoutIcon:!0,showMaximiseIcon:!0,showCloseIcon:!0,responsiveMode:"onload",tabOverlapAllowance:0,reorderOnTabMenuClick:!0,tabControlOffset:10},dimensions:{borderWidth:5,borderGrabWidth:15,minItemHeight:10,minItemWidth:10,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200},labels:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in",tabDropdown:"additional tabs"}};function Ie(t){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ce(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ke(t,e){return(ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ee(t);if(e){var o=Ee(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return xe(this,n)}}function xe(t,e){return!e||"object"!==Ie(e)&&"function"!=typeof e?De(t):e}function De(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ke(t,e)}(s,t);var e,n,i,r=Se(s);function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(n=r.call(this)).isInitialised=!1,n._isFullPage=!1,n._resizeTimeoutId=null,n._components={},n._itemAreas=[],n._resizeFunction=f(n._onResize,De(n)),n._unloadFunction=f(n._onUnload,De(n)),n._maximisedItem=null,n._maximisePlaceholder=o()('<div class="lm_maximise_place"></div>'),n._creationTimeoutPassed=!1,n._subWindowsCreated=!1,n._dragSources=[],n._updatingColumnsResponsive=!1,n._firstLoad=!0,n.width=null,n.height=null,n.root=null,n.openPopouts=[],n.selectedItem=null,n.isSubWindow=!1,n.eventHub=new x(De(n)),n.config=n._createConfig(t),n.container=e,n.dropTargetIndicator=null,n.transitionIndicator=null,n.tabDropPlaceholder=o()('<div class="lm_drop_tab_placeholder"></div>'),!0===n.isSubWindow&&o()("body").css("visibility","hidden"),n._typeToItem={column:f(zt,De(n),[!0]),row:f(zt,De(n),[!1]),stack:Et,component:ae},n}return e=s,(n=[{key:"minifyConfig",value:function(t){return(new g).minifyConfig(t)}},{key:"unminifyConfig",value:function(t){return(new g).unminifyConfig(t)}},{key:"registerComponent",value:function(t,e){if("function"!=typeof e)throw new Error("Please register a constructor function");if(void 0!==this._components[t])throw new Error("Component "+t+" is already registered");this._components[t]=e}},{key:"registerComponentFunction",value:function(t){if("function"!=typeof t)throw new Error("Please register a callback function");void 0!==this._componentFunction&&console.warn("Multiple component functions are being registered.  Only the final registered function will be used."),this._componentFunction=t}},{key:"toConfig",value:function(t){var e,n,i;if(!1===this.isInitialised)throw new Error("Can't create config, layout not yet initialised");if(t&&!(t instanceof X))throw new Error("Root must be a ContentItem");for((e={settings:l({},this.config.settings),dimensions:l({},this.config.dimensions),labels:l({},this.config.labels)}).content=[],(n=function(t,e){var i,o;for(i in e.config)"content"!==i&&(t[i]=e.config[i]);if(e.contentItems.length)for(t.content=[],o=0;o<e.contentItems.length;o++)t.content[o]={},n(t.content[o],e.contentItems[o])})(e,t?{contentItems:[t]}:this.root),this._$reconcilePopoutWindows(),e.openPopouts=[],i=0;i<this.openPopouts.length;i++)e.openPopouts.push(this.openPopouts[i].toConfig());return e.maximisedItemId=this._maximisedItem?"__glMaximised":null,e}},{key:"getComponent",value:function(t){var e=this.getComponentNameFromConfig(t),n=this._components[e];if(void 0!==this._componentFunction&&(n=n||this._componentFunction({config:t})),void 0===n)throw new $('Unknown component "'+e+'"');return n}},{key:"init",value:function(){if(!1===this._subWindowsCreated&&(this._createSubWindows(),this._subWindowsCreated=!0),"loading"!==document.readyState&&null!==document.body){if(!0===this.isSubWindow&&!1===this._creationTimeoutPassed)return setTimeout(f(this.init,this),7),void(this._creationTimeoutPassed=!0);!0===this.isSubWindow&&this._adjustToWindowMode(),this._setContainer(),this.dropTargetIndicator=new ge(this.container),this.transitionIndicator=new be,this.updateSize(),this._create(this.config),this._bindEvents(),this.isInitialised=!0,this._adjustColumnsResponsive(),this.emit("initialised")}else o()(document).ready(f(this.init,this))}},{key:"updateSize",value:function(t,e){2===arguments.length?(this.width=t,this.height=e):(this.width=this.container.width(),this.height=this.container.height()),!0===this.isInitialised&&(this.root.callDownwards("setSize",[this.width,this.height]),this._maximisedItem&&(this._maximisedItem.element.width(this.container.width()),this._maximisedItem.element.height(this.container.height()),this._maximisedItem.callDownwards("setSize")),this._adjustColumnsResponsive())}},{key:"destroy",value:function(){!1!==this.isInitialised&&(this._onUnload(),o()(window).off("resize",this._resizeFunction),o()(window).off("unload beforeunload",this._unloadFunction),this.root.callDownwards("_$destroy",[],!0),this.root.contentItems=[],this.tabDropPlaceholder.remove(),this.dropTargetIndicator.destroy(),this.transitionIndicator.destroy(),this.eventHub.destroy(),this._dragSources.forEach((function(t){t._dragListener.destroy(),t._element=null,t._itemConfig=null,t._dragListener=null})),this._dragSources=[])}},{key:"isReactConfig",value:function(t){return"react-component"===t.type||"lm-react-component"===t.componentName}},{key:"getComponentNameFromConfig",value:function(t){return this.isReactConfig(t)?t.component:t.componentName}},{key:"createContentItem",value:function(t,e){var n;if("string"!=typeof t.type)throw new $("Missing parameter 'type'",t);if(this.isReactConfig(t)&&(t.type="component",t.componentName="lm-react-component"),!this._typeToItem[t.type])throw n="Unknown type '"+t.type+"'. Valid types are "+function(t){var e,n;if("function"==typeof Object.keys)return Object.keys(t);for(n in e=[],t)e.push(n);return e}(this._typeToItem).join(","),new $(n);return"component"!==t.type||e instanceof Et||!e||!0===this.isSubWindow&&e instanceof Ut||(t={type:"stack",width:t.width,height:t.height,content:[t]}),new this._typeToItem[t.type](this,t,e)}},{key:"createPopout",value:function(t,e,n,i){var o,r,s,a,l,c,u=t,f=t instanceof X,m=this;if(n=n||null,f){for(u=this.toConfig(t).content,n=d(),a=t.parent,l=t;1===a.contentItems.length&&!a.isRoot;)a=a.parent,l=l.parent;a.addId(n),isNaN(i)&&(i=h(l,a.contentItems))}else u instanceof Array||(u=[u]);return!e&&f&&(o=window.screenX||window.screenLeft,r=window.screenY||window.screenTop,e={left:o+(s=t.element.offset()).left,top:r+s.top,width:t.element.width(),height:t.element.height()}),e||f||(e={left:window.screenX||window.screenLeft+20,top:window.screenY||window.screenTop+20,width:500,height:309}),f&&t.remove(),(c=new me(u,e,n,i,this)).on("initialised",(function(){m.emit("windowOpened",c)})),c.on("closed",(function(){m._$reconcilePopoutWindows()})),this.openPopouts.push(c),c}},{key:"createDragSource",value:function(t,e){this.config.settings.constrainDragToContainer=!1;var n=new ye(o()(t),e,this);return this._dragSources.push(n),n}},{key:"removeDragSource",value:function(t){t.destroy(),lm.utils.removeFromArray(t,this._dragSources)}},{key:"selectItem",value:function(t,e){if(!0!==this.config.settings.selectionEnabled)throw new Error("Please set selectionEnabled to true to use this feature");t!==this.selectedItem&&(null!==this.selectedItem&&this.selectedItem.deselect(),t&&!0!==e&&t.select(),this.selectedItem=t,this.emit("selectionChanged",t))}},{key:"_$maximiseItem",value:function(t){null!==this._maximisedItem&&this._$minimiseItem(this._maximisedItem),this._maximisedItem=t,t.on("beforeItemDestroyed",this._$cleanupBeforeMaximisedItemDestroyed,this),this._maximisedItem.addId("__glMaximised"),t.element.addClass("lm_maximised"),t.element.after(this._maximisePlaceholder),this.root.element.prepend(t.element),t.element.width(this.container.width()),t.element.height(this.container.height()),t.callDownwards("setSize"),this._maximisedItem.emit("maximised"),this.emit("stateChanged")}},{key:"_$minimiseItem",value:function(t){t.element.removeClass("lm_maximised"),t.removeId("__glMaximised"),this._maximisePlaceholder.after(t.element),this._maximisePlaceholder.remove(),t.parent.callDownwards("setSize"),this._maximisedItem=null,t.off("beforeItemDestroyed",this._$cleanupBeforeMaximisedItemDestroyed,this),t.emit("minimised"),this.emit("stateChanged")}},{key:"_$cleanupBeforeMaximisedItemDestroyed",value:function(){this._maximisedItem===event.origin&&(this._maximisedItem.off("beforeItemDestroyed",this._$cleanupBeforeMaximisedItemDestroyed,this),this._maximisedItem=null)}},{key:"_$closeWindow",value:function(){window.setTimeout((function(){window.close()}),1)}},{key:"_$getArea",value:function(t,e){var n,i,o=1/0,r=null;for(n=0;n<this._itemAreas.length;n++)t>(i=this._itemAreas[n]).x1&&t<i.x2&&e>i.y1&&e<i.y2&&o>i.surface&&(o=i.surface,r=i);return r}},{key:"_$createRootItemAreas",value:function(){var t={y2:"y1",x2:"x1",y1:"y2",x1:"x2"};for(var e in t){var n=this.root._$getArea();n.side=e,"2"===t[e][1]?n[e]=n[t[e]]-50:n[e]=n[t[e]]+50,n.surface=(n.x2-n.x1)*(n.y2-n.y1),this._itemAreas.push(n)}}},{key:"_$calculateItemAreas",value:function(){var t,e,n=this._getAllContentItems();if(this._itemAreas=[],1!==n.length){for(this._$createRootItemAreas(),t=0;t<n.length;t++)if(n[t].isStack&&null!==(e=n[t]._$getArea()))if(e instanceof Array)this._itemAreas=this._itemAreas.concat(e);else{this._itemAreas.push(e);var i={};l(i,e),l(i,e.contentItem._contentAreaDimensions.header.highlightArea),i.surface=(i.x2-i.x1)*(i.y2-i.y1),this._itemAreas.push(i)}}else this._itemAreas.push(this.root._$getArea())}},{key:"_$normalizeContentItem",value:function(t,e){if(!t)throw new Error("No content item defined");if(u(t)&&(t=t()),t instanceof X)return t;if(o.a.isPlainObject(t)&&t.type){var n=this.createContentItem(t,e);return n.callDownwards("_$init"),n}throw new Error("Invalid contentItem")}},{key:"_$reconcilePopoutWindows",value:function(){var t,e=[];for(t=0;t<this.openPopouts.length;t++)!1===this.openPopouts[t].getWindow().closed?e.push(this.openPopouts[t]):this.emit("windowClosed",this.openPopouts[t]);this.openPopouts.length!==e.length&&(this.openPopouts=e,this.emit("stateChanged"))}},{key:"_getAllContentItems",value:function(){var t=[];return function e(n){if(t.push(n),n.contentItems instanceof Array)for(var i=0;i<n.contentItems.length;i++)e(n.contentItems[i])}(this.root),t}},{key:"_bindEvents",value:function(){this._isFullPage&&o()(window).resize(this._resizeFunction),o()(window).on("unload beforeunload",this._unloadFunction)}},{key:"_onResize",value:function(){clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(f(this.updateSize,this),100)}},{key:"_createConfig",value:function(t){var e=this,n=a("gl-window");return n&&(this.isSubWindow=!0,t=localStorage.getItem(n),t=JSON.parse(t),t=(new g).unminifyConfig(t),localStorage.removeItem(n)),function t(n){for(var i in n)"props"!==i&&"object"===Ie(n[i])?t(n[i]):"type"===i&&e.isReactConfig(n)&&(n.type="component",n.componentName="lm-react-component")}(t=o.a.extend(!0,{},we,t)),!1===t.settings.hasHeaders&&(t.dimensions.headerHeight=0),t}},{key:"_adjustToWindowMode",value:function(){var t=o()('<div class="lm_popin" title="'+this.config.labels.popin+'"><div class="lm_icon"></div><div class="lm_bg"></div></div>');t.click(f((function(){this.emit("popIn")}),this)),document.title=m(this.config.content[0].title),o()("head").append(o()("body link, body style, template, .gl_keep")),this.container=o()("body").html("").css("visibility","visible").append(t),document.body.offsetHeight,window.__glInstance=this}},{key:"_createSubWindows",value:function(){var t,e;for(t=0;t<this.config.openPopouts.length;t++)e=this.config.openPopouts[t],this.createPopout(e.content,e.dimensions,e.parentId,e.indexInParent)}},{key:"_setContainer",value:function(){var t=o()(this.container||"body");if(0===t.length)throw new Error("GoldenLayout container not found");if(t.length>1)throw new Error("GoldenLayout more than one container element specified");t[0]===document.body&&(this._isFullPage=!0,o()("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"})),this.container=t}},{key:"_create",value:function(t){var e;if(!(t.content instanceof Array))throw e=void 0===t.content?"Missing setting 'content' on top level of configuration":"Configuration parameter 'content' must be an array",new $(e,t);if(t.content.length>1)throw new $(e="Top level content can't contain more then one element.",t);this.root=new Ut(this,{content:t.content},this.container),this.root.callDownwards("_$init"),"__glMaximised"===t.maximisedItemId&&this.root.getItemsById(t.maximisedItemId)[0].toggleMaximise()}},{key:"_onUnload",value:function(){if(!0===this.config.settings.closePopoutsOnUnload)for(var t=0;t<this.openPopouts.length;t++)this.openPopouts[t].close()}},{key:"_adjustColumnsResponsive",value:function(){if(this._useResponsiveLayout()&&!this._updatingColumnsResponsive&&this.config.dimensions&&this.config.dimensions.minItemWidth&&0!==this.root.contentItems.length&&this.root.contentItems[0].isRow){this._firstLoad=!1;var t=this.root.contentItems[0].contentItems.length;if(!(t<=1)){var e=this.config.dimensions.minItemWidth;if(!(t*e<=this.width)){this._updatingColumnsResponsive=!0;for(var n=t-Math.max(Math.floor(this.width/e),1),i=this.root.contentItems[0],o=this._findAllStackContainers()[0],r=0;r<n;r++){var s=i.contentItems[i.contentItems.length-1];this._addChildContentItemsToContainer(o,s)}this._updatingColumnsResponsive=!1}}}else this._firstLoad=!1}},{key:"_useResponsiveLayout",value:function(){return this.config.settings&&("always"==this.config.settings.responsiveMode||"onload"==this.config.settings.responsiveMode&&this._firstLoad)}},{key:"_addChildContentItemsToContainer",value:function(t,e){"stack"===e.type?e.contentItems.forEach((function(n){t.addChild(n),e.removeChild(n,!0)})):e.contentItems.forEach(f((function(e){this._addChildContentItemsToContainer(t,e)}),this))}},{key:"_findAllStackContainers",value:function(){var t=[];return this._findAllStackContainersRecursive(t,this.root),t}},{key:"_findAllStackContainersRecursive",value:function(t,e){e.contentItems.forEach(f((function(e){"stack"==e.type?t.push(e):e.isComponent||this._findAllStackContainersRecursive(t,e)}),this))}}])&&Ce(e.prototype,n),i&&Ce(e,i),s}(p)}])}));
//# sourceMappingURL=golden-layout.min.js.map